SELECT c.CourseName, creg.Grade FROM StudentRegistrationsToDegrees as sreg, CourseRegistrations as creg, CourseOffers as coffer, Courses as c where sreg.StudentId = %1% and sreg.StudentRegistrationId = creg.StudentRegistrationId and creg.Grade >= 5 and creg.CourseOfferId = coffer.CourseOfferId AND coffer.CourseId = c.CourseId AND sreg.DegreeId = %2% ORDER BY coffer.Year, coffer.Quartile, coffer.CourseOfferId;
WITH ExcellentStudentRegistrations AS (SELECT StudentRegistrationId FROM DegreeProgress WHERE GPA > %1% AND AcqECTS > TotalECTS EXCEPT (SELECT StudentRegistrationId FROM CourseRegistrations WHERE Grade < 5)) SELECT DISTINCT StudentId FROM ExcellentStudentRegistrations ESR, DegreeProgress DP WHERE ESR.StudentRegistrationId = DP.StudentRegistrationId ORDER BY StudentId;
SELECT 0;
SELECT (count(DISTINCT S.StudentId) FILTER(WHERE Gender='F')/CAST(count(DISTINCT S.StudentId) AS DECIMAL)) AS percentage  FROM Degrees D, StudentRegistrationsToDegrees SRTD, Students S WHERE Dept = %1% AND D.DegreeId = SRTD.DegreeId AND S.StudentId = SRTD.StudentId;
SELECT 0;
WITH BestGrades AS (SELECT DISTINCT ON(CR.CourseOfferId) CR.CourseOfferId, Grade FROM CourseRegistrations CR, CourseOffers CO WHERE CO.CourseOfferId = CR.CourseOfferId AND CO.Quartile = 1 AND CO.Year=2018 ORDER BY CR.CourseOfferId, CR.Grade DESC NULLS LAST), Stud AS (SELECT CR.CourseOfferId, StudentregistrationId, CR.Grade FROM CourseRegistrations CR, CourseOffers CO WHERE CO.CourseOfferId = CR.CourseOfferId AND CO.Quartile = 1 AND CO.Year=2018) SELECT StudentId, count(StudentId) as numberOfCoursesWhereExcellent FROM Stud S, BestGrades BG, StudentRegistrationsToDegrees SRTD WHERE BG.CourseOfferId = S.CourseOfferId AND BG.Grade = S.Grade AND S.StudentRegistrationId = SRTD.StudentRegistrationId GROUP BY StudentId HAVING count(StudentId) >= %1%;
SELECT 0;
SELECT 0;